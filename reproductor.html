<!DOCTYPE html>
<html lang="es">
<head>
<meta name="robots" content="noindex" />
<script src="https://content.jwplatform.com/libraries/KB5zFt7A.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/console-ban@4.1.0/dist/console-ban.min.js"></script>
<style type="text/css">
    /* Apariencia General */
    body {
        margin: 0;
        padding: 0;
        overflow: hidden;
    }
    #player {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        height: 100%;
        width: 100%;
        overflow: hidden;
    }
    /* Ajustes para Android TV */
    #player:focus {
        outline: none; /* Eliminar el borde de enfoque para mejorar la apariencia en TV */
    }
    /* Estilos para el popup */
    .popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        padding: 20px;
        border: 1px solid #ccc;
        z-index: 9999;
    }
</style>
<script>
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\[").replace(/[\]]/, "\]");
        var regex = new RegExp("[\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    var getURL = getParameterByName('get');
    var getIMG = getParameterByName('img');
    var getKEY = getParameterByName('key');
    var getKEY2 = getParameterByName('key2');
</script>
</head>
<body>
<div id="player" tabindex="0"></div> <!-- Añadir tabindex para que el reproductor pueda recibir el enfoque con el mando -->
<!-- Popup para seleccionar la calidad -->
<div id="qualityPopup" class="popup">
    <h2>Seleccionar Calidad</h2>
    <select id="qualitySelect">
        <!-- Las opciones de calidad se agregarán aquí dinámicamente -->
    </select>
    <button onclick="applyQuality()">Aplicar</button>
</div>

<script>
var playerInstance = jwplayer("player");
playerInstance.setup({
    playlist: [{
        "title": "Rustico TV | Star+",
        "description": "Mirar Star+ de manera gratuita",
        "image": getIMG,
        "sources": [{
            "default": true, // Establecer como verdadero para seleccionar esta calidad por defecto
            "type": "dash",
            "file": getURL,
            "drm": {
                "clearkey": {"keyId": getKEY, "key": getKEY2}
            },
            "label": "720p" // Etiqueta para identificar la calidad 720p (6926 kbps)
        }]
    }],
    width: "100%",
    height: "100%",
    aspectratio: "16:9",
    autostart: true, // Desactivar la reproducción automática
    cast: {},
    controls: true // Activar los controles del reproductor
});

// Evento para mostrar el popup cuando se presiona la flecha hacia arriba
document.addEventListener("keydown", function(event) {
    if (event.key === "ArrowUp") {
        showPopup();
    }
});

// Función para mostrar el popup y cargar las opciones de calidad
function showPopup() {
    var popup = document.getElementById("qualityPopup");
    popup.style.display = "block";

    // Obtener las calidades disponibles del reproductor
    var qualities = playerInstance.getQualityLevels();
    var select = document.getElementById("qualitySelect");
    select.innerHTML = "";

    // Agregar opciones de calidad al select
    qualities.forEach(function(quality, index) {
        var option = document.createElement("option");
        option.value = index;
        option.textContent = quality.label;
        select.appendChild(option);
    });
}

// Función para aplicar la calidad seleccionada por el usuario
function applyQuality() {
    var select = document.getElementById("qualitySelect");
    var selectedIndex = select.value;
    playerInstance.setCurrentQuality(parseInt(selectedIndex));
    hidePopup();
}

// Función para ocultar el popup
function hidePopup() {
    var popup = document.getElementById("qualityPopup");
    popup.style.display = "none";
}
</script>
</body>
</html>
